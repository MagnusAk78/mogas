@import viewdata._

@(issueForm: Form[models.formdata.IssueForm.Data], parentObjectData: AmlObjectData, 
	userStatus: UserStatus)(implicit flash: Flash, request: RequestHeader, messages: Messages, 
	lang: Lang, webJarAssets: WebJarAssets)

@import components.utils._
@import templates._
@import components.buttons._
@import components.media._
@import forms._
@import helper._
@implicitField = @{ FieldConstructor(forms.horizontalFieldConstructor.f("col-sm-4 col-md-3", "col-sm-8 col-md-9")) }

@main(MainViewData(Messages("createIssue"), viewdata.NavTypes.Browse, userStatus)) {

	@browseTabs(userStatus)

	@rowLargeSmall() {
        @{
            var linkList = List(controllers.routes.DomainController.domain(parentObjectData.domain.uuid, 1),
                controllers.routes.DomainController.hierarchy(parentObjectData.hierarchy.uuid, 1))
                
            var textList = List(parentObjectData.domain.name, parentObjectData.hierarchy.name)

            for(amlObject <- parentObjectData.amlObjectChain) {
            	val link = if(amlObject.modelType == models.Types.ElementType.stringValue) {
                		controllers.routes.DomainController.element(amlObject.uuid, 1, 1)
                	} else {
                		controllers.routes.DomainController.interface(amlObject.uuid)
                	}
                linkList = linkList ::: List(link) 
                	
                textList = textList ::: List(amlObject.name)
			}

            breadcrumb(linkList, textList)
        }
        <h1>
        	@Messages("createIssue")
        </h1>
        <div class="m-t-1">
    	@helper.form(action = routes.IssueController.submitCreate(parentObjectData.amlObjectChain.last.uuid)) {
    		@helper.CSRF.formField
    		@helper.inputText(issueForm("name"), 'class-> "form-control", 'placeholder -> Messages("name"))
    		@submitButton(Messages("create"))	
		}        	
    	</div>        
    }{		
    	@if(parentObjectData.amlObjectChain.last.modelType == models.Types.InterfaceType.stringValue) {
			@button(
				routes.DomainController.interface(parentObjectData.amlObjectChain.last.uuid),
				Messages("back"),
				"btn-secondary",
				Some("fa fa-caret-left fa-fw"))    		
    	} else {
			@button(
				routes.DomainController.element(parentObjectData.amlObjectChain.last.uuid, 1, 1),
				Messages("back"),
				"btn-secondary",
				Some("fa fa-caret-left fa-fw"))
		}
    }	
}
